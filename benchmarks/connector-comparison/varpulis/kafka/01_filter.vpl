connector Broker = kafka(brokers: "localhost:9092", group_id: "varpulis-bench-01")

event StockTick:
    symbol: str
    price: float
    volume: int

stream Input = StockTick.from(Broker, topic: "bench-01-input")

stream Filtered = Input
    .where(price > 50.0)
    .emit(event_type: "FilteredTick", symbol: symbol, price: price)
    .to(Broker, topic: "bench-01-output")
