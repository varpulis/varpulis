event A {
    integer id;
}

event B {
    integer id;
}

event Match {
    integer a_id;
    integer b_id;
}

monitor SequenceDetectionKafka {
    action onload() {
        monitor.subscribe("kafka:bench-07-A");
        monitor.subscribe("kafka:bench-07-B");
        on all A() as a {
            on B(id=a.id) as b within(60.0) {
                send Match(a.id, b.id) to "kafka:bench-07-output";
            }
        }
    }
}
